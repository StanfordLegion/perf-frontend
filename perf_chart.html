<!DOCTYPE html>
<html>
  <head>
    <title>Legion Performance Testing</title>
  </head>
  <body>

    <canvas id="myChart" width="400" height="400"></canvas>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.bundle.min.js"></script>
    <script>
    var getJSON = function(url, callback) {
      var xhr = new XMLHttpRequest();
      xhr.open("get", url, true);
      xhr.responseType = "json";
      xhr.onload = function() {
        var status = xhr.status;
        if (status == 200) {
          callback(null, xhr.response);
        } else {
        callback(status);
        }
      };
      xhr.send();
    };

    var render = function(data) {
      var input_data = data["circuit"]["n0004.sapling.stanford.edu"]["-l 10 -p 100 -npp 2 -wpp 4 -ll:cpu 2"];
      var count = input_data.length;
      var output_data = [];
      for (var i = 0; i < count; i++) {
        output_data[i] = input_data[i]["time_seconds"];
      }

      var ctx = document.getElementById("myChart");
      var myChart = new Chart(ctx, {
        type: "line",
        data: {
          labels: ["circuit"],
          datasets: [{
            label: "Time (seconds)",
            data: output_data,
          }]
        },
        options: {
          responsive: false
        }
      });
    }

    getJSON("https://raw.githubusercontent.com/StanfordLegion/perf-data/master/rendered/chart.json",
    function(err, data) {
      if (err != null) {
        alert("Error: " + err);
      } else {
        render(data);
      }
    });

    </script>
  </body>
</html>
